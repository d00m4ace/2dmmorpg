//--------------------------------------------------------------------------------------
void (*GAME_SCREEN_UPDATE)(void);
void (*GAME_SCREEN_EXIT)(void);

void game_screen_update(void)
{
	if(GAME_SCREEN_UPDATE != NULL)
		GAME_SCREEN_UPDATE();
}

void game_screen_exit(void)
{
	if(GAME_SCREEN_EXIT != NULL)
		GAME_SCREEN_EXIT();

	GAME_SCREEN_UPDATE = NULL;
	GAME_SCREEN_EXIT = NULL;
}
//--------------------------------------------------------------------------------------
#include "gamescreens/screenlogin.c"
//--------------------------------------------------------------------------------------
int main(void)
{
	//--------------------------------------------------------------------------------------
	// Initialization
	//--------------------------------------------------------------------------------------
	hal_system_init();
	game_init();
	//--------------------------------------------------------------------------------------
	// low end android 1280x720
	//static int SCR_WIDTH_MIN = 320;
	//static int SCR_HEIGHT_MIN = 180;
	// hi end android 1080+
	static int SCR_WIDTH_MIN = 422;
	static int SCR_HEIGHT_MIN = 216;
	//--------------------------------------------------------------------------------------
	static int SCR_W_BORDER_MAX = 5;
	static int SCR_H_BORDER_MAX = 0;
#ifdef _WIN32	
	SCR_W_BORDER_MAX = 6;
	SCR_H_BORDER_MAX = 6;
#endif
	game_scr_init(SCR_WIDTH_MIN, SCR_HEIGHT_MIN, SCR_W_BORDER_MAX, SCR_H_BORDER_MAX);
	//--------------------------------------------------------------------------------------
	GAME_SCREEN_UPDATE = NULL;
	GAME_SCREEN_EXIT = NULL;
	//--------------------------------------------------------------------------------------
	{
		GUI_DISPLAY* dsp = gui_display(0);
		gui_add_display(dsp);
	}

	//game_txt_set_lang(TXT_LANG_ID_RU);

	screenlogin_enter();

	//--------------------------------------------------------------------------------------
	// Main game loop
	//--------------------------------------------------------------------------------------
	while(!hal_window_is_close())    // Detect window close button or ESC key
	{
		//----------------------------------------------------------------------------------
		// GAME UPDATE
		//----------------------------------------------------------------------------------
		game_screen_update();
		//----------------------------------------------------------------------------------
		// GUI UPDATE
		//----------------------------------------------------------------------------------
		gui_update();
		//----------------------------------------------------------------------------------
		// GAME SCREEN RENDER
		//----------------------------------------------------------------------------------
		if(hal_gesture_detected(GESTURE_DOUBLETAP))
		{
			GUI_ELEM* elm = gui_input_elm_pressed();

			if(elm != NULL && elm->pln)
				gui_plane_scroll_to(elm->pln, elm->pos);
		}
		//----------------------------------------------------------------------------------
		// GUI DRAW
		//----------------------------------------------------------------------------------
		gui_draw();
		//----------------------------------------------------------------------------------
		// Draw to screen
		//----------------------------------------------------------------------------------
		hal_draw_begin();

		hal_cls(ARGB32(0, 0, 0, 255));

		game_scr_draw();

		hal_draw_fps(20, 0);
		hal_draw_end();
		//----------------------------------------------------------------------------------
	}

	//--------------------------------------------------------------------------------------
	// De-Initialization
	//--------------------------------------------------------------------------------------
	hal_system_shutdown();
	game_shutdown();
	return 0;
}
//--------------------------------------------------------------------------------------